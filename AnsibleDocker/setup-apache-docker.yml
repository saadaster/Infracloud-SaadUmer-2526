---
- name: Apache draaien in Docker
  hosts: servers
  become: true

  tasks:
    - name: Maak een map voor de website bestanden
      file:
        path: /opt/mijn-website
        state: directory
        mode: '0755'

    - name: Kopieer de index.html van mijn computer naar de server
      copy:
        src: files/index.html   
        dest: /opt/mijn-website/index.html
        mode: '0644'

    - name: Maak het docker-compose bestand aan
      copy:
        dest: /opt/mijn-website/docker-compose.yml
        content: |
          services:
            webserver:
              image: httpd:latest
              ports:
                - "80:80"
              volumes:
                - ./index.html:/usr/local/apache2/htdocs/index.html
              restart: always

    - name: Start de Apache container
      community.docker.docker_compose_v2:
        project_src: /opt/mijn-website
        state: present